# ๐ฆ ุฏููู ุงุณุชุฎุฏุงู Bon de Livraison PDF Handler

## ูุธุฑุฉ ุนุงูุฉ
ููู ูููุตู ูุญุชูู ุนูู ููุฏ ูุชุฎุตุต ูุชุญููู PDF ุฎุงุต ุจู **"Bon de livraison"** ููุท ูุดุฑูุฉ CHAIMAE.

---

## ๐ ุงูููู
```
frontend/pages/bon_livraison_pdf_handler.js
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1๏ธโฃ ุฅุถุงูุฉ ุงูููู ุฅูู HTML
ุฃุถู ุงูุณุทุฑ ุงูุชุงูู ูู `index.html`:

```html
<script src="frontend/pages/bon_livraison_pdf_handler.js"></script>
```

### 2๏ธโฃ ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ
ุงุณุชุฎุฏู ุงูุฏุงูุฉ ูู ุฃู ููุงู ูู ุงูุชุทุจูู:

```javascript
// ุชุญููู PDF ูู Bon de Livraison
downloadBonLivraisonPDF(invoiceId);
```

### 3๏ธโฃ ูุซุงู ุนููู - ุฒุฑ ูู ุงูุฌุฏูู

```html
<button onclick="downloadBonLivraisonPDF(${invoice.id})" 
        title="ุชุญููู Bon de Livraison PDF"
        style="
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #FF9800 0%, #FB8C00 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        ">
    ๐ฅ ุชุญููู Bon de Livraison
</button>
```

---

## ๐จ ุงูุชุตููู ูุงูููุฒุงุช

### โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

1. **ุชุญูู ูู ููุน ุงููุณุชูุฏ**
   - ูุชุญูู ุชููุงุฆูุงู ุฃู ุงูููุน ูู `bon_livraison` ุฃู `bl`
   - ูุฑูุน ุฎุทุฃ ุฅุฐุง ูุงู ููุน ุขุฎุฑ

2. **ูุงูุฐุฉ ุงุฎุชูุงุฑ ุฑูู ุงูุฃูุฑ**
   - ุชุธูุฑ ููุท ุฅุฐุง ูุงู ููุงู `document_numero_commande`
   - ุชุตููู ุงุญุชุฑุงูู ูุน ููู ุจุฑุชูุงูู
   - ุฎูุงุฑ ูุฅุถุงูุฉ ุฃู ุนุฏู ุฅุถุงูุฉ ุงูุฑูู ูู PDF

3. **ูุงูุฐุฉ ุงูููุชุฌุงุช ุจููู ุตูุฑูุฉ**
   - ุชุธูุฑ ุฅุฐุง ูุงู ููุงู ููุชุฌุงุช ุจู ูููุฉ = 0 ุฃู ุณุนุฑ = 0
   - ุฎูุงุฑ ูุฅุธูุงุฑ ุฃู ุฅุฎูุงุก ูุฐู ุงูููุชุฌุงุช

4. **PDF ุงุญุชุฑุงูู**
   - ุฑุฃุณ ูุญุชูู ุนูู ูุนูููุงุช ุงูุดุฑูุฉ ูุงูุนููู
   - ุฌุฏูู ููุธู ูุน ุชูููู ุงูุตููู
   - ููุฎุต ูุงูู (Total HT, TVA, Total TTC)
   - ุชุฐููู ูุน ูุนูููุงุช ุงูุงุชุตุงู
   - ุชุฑููู ุงูุตูุญุงุช

---

## ๐ฏ ุงูุฃููุงู ุงููุณุชุฎุฏูุฉ

| ุงูุงุณุชุฎุฏุงู | ุงูููู | ุงูููุฏ |
|-----------|-------|-------|
| ุงูุฑุฃุณ ูุงูุนูุงููู | ุฃุฒุฑู | `#21618C` |
| ุงูุฃุฑูุงู ูุงูุนููุงุก | ุฃุฎุถุฑ | `#4caf50` |
| ุฃุฑูุงู ุงููุซุงุฆู ูุงูุฃูุงูุฑ | ุจุฑุชูุงูู | `#FF9800` |
| ุฎูููุฉ ุงูุตููู | ุฑูุงุฏู ูุงุชุญ | `#F5F5F5` |

---

## ๐ ุจููุฉ ุงูููุฏ

### ุงูุฏูุงู ุงูุฑุฆูุณูุฉ

```javascript
// 1. ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ
downloadBonLivraisonPDF(invoiceId)

// 2. ูุงูุฐุฉ ุงุฎุชูุงุฑ ุฑูู ุงูุฃูุฑ
showBonLivraisonModal(orderNumber)

// 3. ูุงูุฐุฉ ุงูููุชุฌุงุช ุจููู ุตูุฑูุฉ
showZeroProductsModal()

// 4. ุชุญููู ููุชุจุฉ jsPDF
loadJsPDFLibrary()

// 5. ุฅุถุงูุฉ ุงูุฑุฃุณ
addBonLivraisonHeader(doc, invoice, colors, dateStr)

// 6. ุฅุถุงูุฉ ุฌุฏูู ุงูููุชุฌุงุช
addBonLivraisonTable(doc, invoice, colors, includeZeroProducts)

// 7. ุฅุถุงูุฉ ุงูุชุฐููู
addBonLivraisonFooter(doc, colors, pageNum, totalPages)

// 8. ุชูุณูู ุงูุฃุฑูุงู
formatNumberForPDF(num)
```

---

## ๐ง ุงูุชุฎุตูุต

### ุชุบููุฑ ุงูุฃููุงู

ูู ุงูุฏุงูุฉ `downloadBonLivraisonPDF`ุ ุนุฏูู ูุงุฆู `colors`:

```javascript
const colors = {
    blue: [33, 97, 140],      // ููู ุงูุฑุฃุณ
    green: [76, 175, 80],     // ููู ุงูุฃุฑูุงู
    orange: [255, 152, 0],    // ููู ุฃุฑูุงู ุงููุซุงุฆู
    lightGray: [245, 245, 245],
    darkGray: [96, 125, 139]
};
```

### ุชุบููุฑ ูุนูููุงุช ุงูุดุฑูุฉ

ูู ุฏุงูุฉ `addBonLivraisonHeader`ุ ุนุฏูู ุงููุตูุต:

```javascript
doc.text('CHAIMAE ERRBAHI MDIQ sarl (AU)', 105, 20, { align: 'center' });
doc.text('Patente Nยฐ 52003366 - NIF : 40190505', 105, 27, { align: 'center' });
// ... ุฅูุฎ
```

### ุชุบููุฑ ูุนูููุงุช ุงูุชุฐููู

ูู ุฏุงูุฉ `addBonLivraisonFooter`:

```javascript
doc.text('RIB : 007 720 00 05979000000368 12  ATTIJARI WAFA BANQ', 15, 275);
doc.text('Email: errbahiabderrahim@gmail.com', 15, 279);
// ... ุฅูุฎ
```

---

## ๐ ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู ุงููุงูู

```javascript
// ูู ุตูุญุฉ invoices_list_chaimae.js
<button 
    class="btn-icon btn-download" 
    onclick="downloadBonLivraisonPDF(${invoice.id})" 
    title="ุชุญููู Bon de Livraison PDF"
    style="
        background: linear-gradient(135deg, #FF9800 0%, #FB8C00 100%);
        color: white;
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
    ">
    ๐ฅ Bon de Livraison
</button>
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชุญูู ูู ุงูููุน**: ุงูุฏุงูุฉ ุชุชุญูู ุชููุงุฆูุงู ูู ุฃู ุงูููุน ูู `bon_livraison` ุฃู `bl`
2. **ููุชุจุฉ jsPDF**: ุชูุญููู ุชููุงุฆูุงู ูู CDN ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
3. **ุงูุฅุดุนุงุฑุงุช**: ุชุณุชุฎุฏู `window.notify` ูููุฌุงุญ ูุงูุฃุฎุทุงุก
4. **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ุชุณุชุฎุฏู `window.electron.dbChaimae` ูููุตูู ุฅูู ุงูุจูุงูุงุช

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุธูุฑ ุดูุก
**ุงูุญู**: ุชุฃูุฏ ูู:
- ุชุญููู ุงูููู ูู `index.html`
- ุฃู `invoiceId` ุตุญูุญ
- ุฃู ุงูุจูุงูุงุช ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงููุดููุฉ: ุฎุทุฃ ูู jsPDF
**ุงูุญู**: ุชุฃูุฏ ูู:
- ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช (ูุชุญููู CDN)
- ุฃู ูู ุจุชุญููู jsPDF ูุญููุงู

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ
**ุงูุญู**: ุชุฃูุฏ ูู ูุฌูุฏ `window.notify` ูู ุงูุชุทุจูู

---

## ๐ ุงููููุงุช ุฐุงุช ุงูุตูุฉ

- `invoices_list_chaimae.js` - ูุงุฆูุฉ ุงูููุงุชูุฑ
- `index.html` - ุงูููู ุงูุฑุฆูุณู
- `frontend/scripts/notifications.js` - ูุธุงู ุงูุฅุดุนุงุฑุงุช

---

## ๐ ูุซุงู ูุชูุฏู - ุฅุถุงูุฉ ุฒุฑ ูุดุฑูุท

```javascript
// ุฃุถู ูุฐุง ุงูููุฏ ูู displayInvoicesChaimae()
if (invoice.document_type === 'bon_livraison' || invoice.document_type === 'bl') {
    // ุฅุถุงูุฉ ุฒุฑ ุฎุงุต ูู Bon de Livraison
    const bonLivraisonBtn = `
        <button 
            onclick="downloadBonLivraisonPDF(${invoice.id})"
            style="
                padding: 0.5rem 1rem;
                background: linear-gradient(135deg, #FF9800 0%, #FB8C00 100%);
                color: white;
                border: none;
                border-radius: 6px;
                cursor: pointer;
                font-weight: 600;
            ">
            ๐ฅ Bon de Livraison
        </button>
    `;
}
```

---

## โ ุงูุฎูุงุตุฉ

ูุฐุง ุงูููู ูููุฑ:
- โ ููุฏ ูููุตู ููุงุจู ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
- โ ุชุตููู ุงุญุชุฑุงูู ูุญุฏูุซ
- โ ููุงูุฐ ุชูุงุนููุฉ ุฌูููุฉ
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ
- โ ุณูู ุงูุชุฎุตูุต ูุงูุชุนุฏูู
- โ ุฏุนู ูุชุนุฏุฏ ุงูุตูุญุงุช
- โ ุชุฑููู ุงูุตูุญุงุช ุงูุชููุงุฆู

**ุงุณุชูุชุน ุจุงุณุชุฎุฏุงู ุงูููู! ๐**
